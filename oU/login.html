<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Login</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<script>
  document.getElementById('login-form').addEventListener('submit', function(e) {
    e.preventDefault();
    fetch('http://localhost:8080/api/auth/login', {  })
            .then(response => response.json().then(data => ({ ok: response.ok, data })))
            .then(({ ok, data }) => {
              if (ok) {
                localStorage.setItem('authToken', data.token);
                let redirectUrl = '';
                switch (data.role) {
                  case 'ROLE_SUPER_ADMIN': redirectUrl = 'super-admin/dashboard.html'; break;
                  case 'ROLE_BRANCH_ADMIN': redirectUrl = 'branch-admin/dashboard.html'; break;
                  case 'ROLE_ONLINEUSER': redirectUrl = 'user-dashboard.html'; break; // Redirect to user dashboard
                  default: redirectUrl = 'index.html';
                }
                window.location.href = redirectUrl;
              } else { throw new Error(data.message); }
            })
            .catch(error => {
              document.getElementById('login-error').textContent = error.message;
              document.getElementById('login-error').classList.remove('d-none');
            });
  });
</script>
</body>
</html>
